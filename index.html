
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>パルのドボンショッピングゲーム</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      text-align: center;
      padding: 30px;
      background-color: #f5f5f5;
      transition: background-color 0.5s ease;
    }
    .hidden {
      display: none;
    }
    input, textarea, select, button {
      margin-top: 10px;
      padding: 10px;
      width: 80%;
      font-size: 16px;
    }
    .result {
      font-size: 36px;
      font-weight: bold;
      margin-top: 30px;
      padding: 20px;
    }
    .safe {
      color: green;
      background-color: #d8ffd8;
      border: 4px solid green;
    }
    .dobon {
      color: white;
      background-color: red;
      border: 4px solid darkred;
      animation: shake 0.5s;
    }
    .mega {
      color: black;
      background-color: gold;
      border: 4px solid orange;
      animation: pulse 1s infinite alternate;
    }
    @keyframes shake {
      0% { transform: translate(1px, 1px) rotate(0deg); }
      20% { transform: translate(-1px, -2px) rotate(-1deg); }
      40% { transform: translate(-3px, 0px) rotate(1deg); }
      60% { transform: translate(3px, 2px) rotate(0deg); }
      80% { transform: translate(1px, -1px) rotate(1deg); }
      100% { transform: translate(-1px, 2px) rotate(-1deg); }
    }
    @keyframes pulse {
      0% { transform: scale(1); }
      100% { transform: scale(1.05); }
    }
  </style>
</head>
<body>

  <div id="setupScreen">
    <h2>パル用：ドボン店設定</h2>
    <label>共通ドボン店（カンマ区切り）</label><br>
    <input type="text" id="commonDobon"><br>

    <label>共通オオドボン店（1つ）</label><br>
    <input type="text" id="megaDobon"><br>

    <h3>パーソナルドボン店（各自1つ）</h3>
    <div>
      なかまん: <input type="text" id="pd_nakaman"><br>
      にき: <input type="text" id="pd_niki"><br>
      せな: <input type="text" id="pd_sena"><br>
      ひざ: <input type="text" id="pd_hiza"><br>
    </div>

    <button onclick="startGame()">ゲーム開始</button>
  </div>

  <div id="gameScreen" class="hidden">
    <h2>買い物チャレンジ！</h2>
    <div id="currentPlayerDisplay" style="font-size:24px; margin-bottom:10px;"></div>

    <label>購入した店</label><br>
    <input type="text" id="storeName"><br>

    <button onclick="checkDobon()">決定！</button>

    <div id="result" class="result"></div>

    <button onclick="nextPlayer()" class="hidden" id="nextBtn">次の人へ</button>
  </div>

  <script>
    let gameSettings = {};
    const players = ["なかまん", "にき", "せな", "ひざ"];
    let currentPlayerIndex = 0;

    function startGame() {
      const common = document.getElementById("commonDobon").value.split(',').map(s => s.trim());
      const mega = document.getElementById("megaDobon").value.trim();

      const personalDobon = {
        "なかまん": document.getElementById("pd_nakaman").value.trim(),
        "にき": document.getElementById("pd_niki").value.trim(),
        "せな": document.getElementById("pd_sena").value.trim(),
        "ひざ": document.getElementById("pd_hiza").value.trim()
      };

      gameSettings = {
        commonDobon: common,
        megaDobon: mega,
        personalDobon: personalDobon
      };

      document.getElementById("setupScreen").classList.add("hidden");
      document.getElementById("gameScreen").classList.remove("hidden");

      showCurrentPlayer();
    }

    function showCurrentPlayer() {
      const player = players[currentPlayerIndex];
      document.getElementById("currentPlayerDisplay").textContent = `プレイヤー：${player}`;
      document.getElementById("storeName").value = "";
      document.getElementById("result").textContent = "";
      document.getElementById("result").className = "result";
      document.getElementById("nextBtn").classList.add("hidden");
    }

    function checkDobon() {
      const player = players[currentPlayerIndex];
      const store = document.getElementById("storeName").value.trim();
      const resultDiv = document.getElementById("result");
      const nextBtn = document.getElementById("nextBtn");

      if (!store) {
        resultDiv.textContent = "店名を入力してください。";
        return;
      }

      let resultText = "";
      resultDiv.className = "result";

      if (gameSettings.commonDobon.includes(store)) {
        resultText = `ドボン！！ ${player}は自腹`;
        resultDiv.classList.add("dobon");
      } else if (gameSettings.megaDobon === store) {
        resultText = `オオドボン！！ ${player}がパルに奢り`;
        resultDiv.classList.add("mega");
      } else if (gameSettings.personalDobon[player] === store) {
        resultText = `パーソナルドボン！！ ${player}だけが自腹`;
        resultDiv.classList.add("dobon");
      } else {
        resultText = `セーフ！${player}、パルごちです！！`;
        resultDiv.classList.add("safe");
      }

      resultDiv.textContent = resultText;
      nextBtn.classList.remove("hidden");
    }

    function nextPlayer() {
      currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
      showCurrentPlayer();
    }
  </script>

</body>
</html>
